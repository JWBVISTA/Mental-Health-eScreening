-- stores graphical template parameters
ALTER TABLE template ADD COLUMN graph_params mediumtext;

-- update all graphical templates to be created by the editor
UPDATE template set
name='Depression',
template_file='<#include \"clinicalnotefunctions\">\n<#-- generated file. Do not change -->\n<#if getFormulaValue(var1599)?string != DEFAULT_VALUE >\n${MODULE_TITLE_START}Depression${MODULE_TITLE_END}\n${GRAPH_SECTION_START}\n ${GRAPH_BODY_START}\n{\"varId\":1599,\"title\":\"My Depression Score\",\"footer\":\"*a score of 10 or greater is a positive screen\",\"numberOfMonths\":12,\"score\":\"${getFormulaValue(var1599)}\",\"intervals\":{\"None\":0.0,\"Minimal\":1.0,\"Mild\":5.0,\"Moderate\":10.0,\"Moderately Severe\":15.0,\"Severe\":20.0},\"maxXPoint\":27.0,\"ticks\":[0.0,1.0,5.0,10.0,15.0,20.0,27.0]}\n ${GRAPH_BODY_END}\n${GRAPH_SECTION_END}\n${MODULE_START}\n<#-- NAME:Depression is when you feel  -->\n<#-- SECTION:1 -->\n<#-- SUMMARY:Depression is when you feel sad and hopeless for much of the time. It affects your body and thoughts, and interferes with daily life. There are effective treatments and resources for dealing with depression.   Recommendation:    -->\nDepression is when you feel sad and hopeless for much of the time. It affects your body and thoughts, and interferes with daily life. There are effective treatments and resources for dealing with depression. <br> <b>Recommendation: </b> <#-- NAME:if_dep_score_phq9 formula_nresult_-->\n<#-- SECTION:2 -->\n<#-- SUMMARY:dep_score_phq9 formula nresult  -->\n<#if (formulaHasNoResult(var1599)) >\n<#-- NAME:Veteran declined to respond  -->\n<#-- SECTION:2.1 -->\n<#-- SUMMARY:Veteran declined to respond  -->\nVeteran declined to respond\n<#elseif ( isDefined(getFormulaValue(var1599)) && getFormulaValue(var1599) < 10) >\n<#-- NAME:Contact a clinician if in the -->\n<#-- SECTION:2.2.1 -->\n<#-- SUMMARY:Contact a clinician if in the future if you ever feel you may have a problem with depression   -->\nContact a clinician if in the future if you ever feel you may have a problem with depression \n<#elseif ( isDefined(getFormulaValue(var1599)) && getFormulaValue(var1599) >= 10) >\n<#-- NAME:Ask your clinician for further-->\n<#-- SECTION:2.3.1 -->\n<#-- SUMMARY:Ask your clinician for further evaluation and treatment options  -->\nAsk your clinician for further evaluation and treatment options\n</#if>\n\n${MODULE_END}\n</#if>',
json_file='[{\"summary\":\"Depression is when you feel sad and hopeless for much of the time. It affects your body and thoughts, and interferes with daily life. There are effective treatments and resources for dealing with depression.   Recommendation:   \",\"name\":\"Depression is when you feel  \",\"section\":\"1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Depression is when you feel sad and hopeless for much of the time. It affects your body and thoughts, and interferes with daily life. There are effective treatments and resources for dealing with depression. <br> <b>Recommendation: </b> \"}],\"type\":\"text\"},{\"summary\":\"dep_score_phq9 formula nresult \",\"name\":\"if_dep_score_phq9 formula_nresult_\",\"section\":\"2\",\"children\":[{\"type\":\"text\",\"summary\":\"Veteran declined to respond \",\"name\":\"Veteran declined to respond  \",\"section\":\"2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Veteran declined to respond\"}],\"type\":\"text\"},{\"type\":\"elseif\",\"summary\":\"dep_score_phq9 formula lt 10\",\"name\":\"elseif_dep_score_phq9 formula_lt_10\",\"section\":\"2.2\",\"children\":[{\"type\":\"text\",\"summary\":\"Contact a clinician if in the future if you ever feel you may have a problem with depression  \",\"name\":\"Contact a clinician if in the \",\"section\":\"2.2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Contact a clinician if in the future if you ever feel you may have a problem with depression \"}],\"type\":\"text\"}],\"operator\":\"lt\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1599,\"name\":\"dep_score_phq9\",\"displayName\":\"dep_score_phq9 formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"10\"},\"conditions\":[],\"type\":\"elseif\"},{\"type\":\"elseif\",\"summary\":\"dep_score_phq9 formula gte 10\",\"name\":\"elseif_dep_score_phq9 formula_gte_10\",\"section\":\"2.3\",\"children\":[{\"type\":\"text\",\"summary\":\"Ask your clinician for further evaluation and treatment options \",\"name\":\"Ask your clinician for further\",\"section\":\"2.3.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Ask your clinician for further evaluation and treatment options\"}],\"type\":\"text\"}],\"operator\":\"gte\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1599,\"name\":\"dep_score_phq9\",\"displayName\":\"dep_score_phq9 formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"10\"},\"conditions\":[],\"type\":\"elseif\"}],\"operator\":\"nresult\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1599,\"name\":\"dep_score_phq9\",\"displayName\":\"dep_score_phq9 formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"\"},\"conditions\":[],\"type\":\"if\"}]',
graph_params='{\"varId\":1599,\"title\":\"My Depression Score\",\"footer\":\"*a score of 10 or greater is a positive screen\",\"numberOfMonths\":12,\"score\":\"${getFormulaValue(var1599)}\",\"intervals\":{\"None\":0.0,\"Minimal\":1.0,\"Mild\":5.0,\"Moderate\":10.0,\"Moderately Severe\":15.0,\"Severe\":20.0},\"maxXPoint\":27.0,\"ticks\":[0.0,1.0,5.0,10.0,15.0,20.0,27.0]}'
where template_id=308;

UPDATE template set
name='Pain',
template_file='<#include \"clinicalnotefunctions\">\n<#-- generated file. Do not change -->\n<#if getResponse(var2300)?string != DEFAULT_VALUE >\n${MODULE_TITLE_START}Pain${MODULE_TITLE_END}\n${GRAPH_SECTION_START}\n ${GRAPH_BODY_START}\n{\"varId\":2300,\"title\":\"My Pain Score\",\"footer\":null,\"numberOfMonths\":12,\"score\":\"${getResponse(var2300)}\",\"intervals\":{\"None\":0.0,\"Minimal\":1.0,\"Moderate\":4.0,\"Severe\":6.0,\"Very Severe\":8.0,\"Worst Possible\":10.0},\"maxXPoint\":null,\"ticks\":[0.0,1.0,4.0,6.0,8.0,10.0]}\n ${GRAPH_BODY_END}\n${GRAPH_SECTION_END}\n${MODULE_START}\n<#-- NAME:Pain can slow healing and stop-->\n<#-- SECTION:1 -->\n<#-- SUMMARY:Pain can slow healing and stop you from being active. Untreated pain can harm your sleep, outlook, and ability to do things.   Recommendation:   -->\nPain can slow healing and stop you from being active. Untreated pain can harm your sleep, outlook, and ability to do things. <br> <b>Recommendation:</b>${NBSP}<#-- NAME:if_Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>._response_0-->\n<#-- SECTION:2 -->\n<#-- SUMMARY:Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 0 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2200 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2201 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2202 -->\n<#if (responseIs(var2300, 2199))  ||  (responseIs(var2300, 2200) )   ||  (responseIs(var2300, 2201) )   ||  (responseIs(var2300, 2202) )  >\n<#-- NAME:Seek medical attention if your-->\n<#-- SECTION:2.1 -->\n<#-- SUMMARY:Seek medical attention if your pain suddenly increases or changes.  -->\nSeek medical attention if your pain suddenly increases or changes.\n<#else>\n<#-- NAME:Tell your clinician if medicat-->\n<#-- SECTION:2.2.1 -->\n<#-- SUMMARY:Tell your clinician if medications aren\'t reducing your pain, or if the pain suddenly increases or changes, and ask for help with managing your pain.  -->\nTell your clinician if medications aren\'t reducing your pain, or if the pain suddenly increases or changes, and ask for help with managing your pain.\n</#if>\n\n${MODULE_END}\n</#if>',
json_file='[{\"summary\":\"Pain can slow healing and stop you from being active. Untreated pain can harm your sleep, outlook, and ability to do things.   Recommendation:  \",\"name\":\"Pain can slow healing and stop\",\"section\":\"1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Pain can slow healing and stop you from being active. Untreated pain can harm your sleep, outlook, and ability to do things. <br> <b>Recommendation:</b>&nbsp;\"}],\"type\":\"text\"},{\"summary\":\"Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 0 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2200 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2201 or Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>. response 2202\",\"name\":\"if_Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>._response_0\",\"section\":\"2\",\"children\":[{\"type\":\"text\",\"summary\":\"Seek medical attention if your pain suddenly increases or changes. \",\"name\":\"Seek medical attention if your\",\"section\":\"2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Seek medical attention if your pain suddenly increases or changes.\"}],\"type\":\"text\"},{\"type\":\"else\",\"section\":\"2.2\",\"children\":[{\"type\":\"text\",\"summary\":\"Tell your clinician if medications aren\'t reducing your pain, or if the pain suddenly increases or changes, and ask for help with managing your pain. \",\"name\":\"Tell your clinician if medicat\",\"section\":\"2.2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Tell your clinician if medications aren\'t reducing your pain, or if the pain suddenly increases or changes, and ask for help with managing your pain.\"}],\"type\":\"text\"}],\"type\":\"else\"}],\"operator\":\"response\",\"left\":{\"type\":\"var\",\"content\":{\"id\":2300,\"name\":\"pain_number\",\"displayName\":\"Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>.\",\"typeId\":1,\"measureId\":220,\"measureTypeId\":2,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"2199\"},\"conditions\":[{\"left\":{\"type\":\"var\",\"content\":{\"id\":2300,\"name\":\"pain_number\",\"displayName\":\"Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>.\",\"typeId\":1,\"measureId\":220,\"measureTypeId\":2,\"measureAnswerId\":null,\"transformations\":[]}},\"operator\":\"response\",\"right\":{\"type\":\"text\",\"content\":\"2200\"},\"conditions\":null,\"connector\":\"or\"},{\"left\":{\"type\":\"var\",\"content\":{\"id\":2300,\"name\":\"pain_number\",\"displayName\":\"Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>.\",\"typeId\":1,\"measureId\":220,\"measureTypeId\":2,\"measureAnswerId\":null,\"transformations\":[]}},\"operator\":\"response\",\"right\":{\"type\":\"text\",\"content\":\"2201\"},\"conditions\":null,\"connector\":\"or\"},{\"left\":{\"type\":\"var\",\"content\":{\"id\":2300,\"name\":\"pain_number\",\"displayName\":\"Please indicate the number that represents how intense your pain has been over the <b>past 4 weeks</b>.\",\"typeId\":1,\"measureId\":220,\"measureTypeId\":2,\"measureAnswerId\":null,\"transformations\":[]}},\"operator\":\"response\",\"right\":{\"type\":\"text\",\"content\":\"2202\"},\"conditions\":null,\"connector\":\"or\"}],\"type\":\"if\"}]',
graph_params='{\"varId\":2300,\"title\":\"My Pain Score\",\"footer\":null,\"numberOfMonths\":12,\"score\":\"${getResponse(var2300)}\",\"intervals\":{\"None\":0.0,\"Minimal\":1.0,\"Moderate\":4.0,\"Severe\":6.0,\"Very Severe\":8.0,\"Worst Possible\":10.0},\"maxXPoint\":null,\"ticks\":[0.0,1.0,4.0,6.0,8.0,10.0]}'
where template_id=309;

UPDATE template set
name='Post-traumatic Stress Disorder',
template_file='<#include \"clinicalnotefunctions\">\n<#-- generated file. Do not change -->\n<#if getFormulaValue(var1929)?string != DEFAULT_VALUE >\n${MODULE_TITLE_START}Post-traumatic Stress Disorder${MODULE_TITLE_END}\n${GRAPH_SECTION_START}\n ${GRAPH_BODY_START}\n{\"varId\":1929,\"title\":\"My PTSD Score\",\"footer\":null,\"numberOfMonths\":12,\"score\":\"${getFormulaValue(var1929)}\",\"intervals\":{\"Negative\":17.0,\"Positive\":44.0},\"maxXPoint\":85.0,\"ticks\":[17.0,31.0,44.0,65.0,85.0]}\n ${GRAPH_BODY_END}\n${GRAPH_SECTION_END}\n${MODULE_START}\n<#-- NAME:PTSD is when remembering a tra-->\n<#-- SECTION:1 -->\n<#-- SUMMARY:PTSD is when remembering a traumatic event keeps you from living a normal life. It\'s also called shell shock or combat stress. Common symptoms include recurring memories or nightmares of the event, sleeplessness, and feeling angry, irritable, or numb.   Recommendation:    -->\nPTSD is when remembering a traumatic event keeps you from living a normal life. It\'s also called shell shock or combat stress. Common symptoms include recurring memories or nightmares of the event, sleeplessness, and feeling angry, irritable, or numb. <br> <b>Recommendation:</b>${NBSP} <#-- NAME:if_pcl_score formula_nresult_-->\n<#-- SECTION:2 -->\n<#-- SUMMARY:pcl_score formula nresult  -->\n<#if (formulaHasNoResult(var1929)) >\n<#-- NAME:Veteran declined to respond -->\n<#-- SECTION:2.1 -->\n<#-- SUMMARY:Veteran declined to respond  -->\nVeteran declined to respond\n<#elseif ( isDefined(getFormulaValue(var1929)) && getFormulaValue(var1929) > 43) >\n<#-- NAME:Ask your clinician for further-->\n<#-- SECTION:2.2.1 -->\n<#-- SUMMARY:Ask your clinician for further evaluation and treatment options   -->\nAsk your clinician for further evaluation and treatment options \n<#elseif ( isDefined(getFormulaValue(var1929)) && getFormulaValue(var1929) <= 43) >\n<#-- NAME:You may ask a clinician for he-->\n<#-- SECTION:2.3.1 -->\n<#-- SUMMARY:You may ask a clinician for help in the future if you feel you may have symptoms of PTSD  -->\nYou may ask a clinician for help in the future if you feel you may have symptoms of PTSD\n</#if>\n\n${MODULE_END}\n</#if>',
json_file='[{\"summary\":\"PTSD is when remembering a traumatic event keeps you from living a normal life. It\'s also called shell shock or combat stress. Common symptoms include recurring memories or nightmares of the event, sleeplessness, and feeling angry, irritable, or numb.   Recommendation:   \",\"name\":\"PTSD is when remembering a tra\",\"section\":\"1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"PTSD is when remembering a traumatic event keeps you from living a normal life. It\'s also called shell shock or combat stress. Common symptoms include recurring memories or nightmares of the event, sleeplessness, and feeling angry, irritable, or numb. <br> <b>Recommendation:</b>&nbsp; \"}],\"type\":\"text\"},{\"summary\":\"pcl_score formula nresult \",\"name\":\"if_pcl_score formula_nresult_\",\"section\":\"2\",\"children\":[{\"type\":\"text\",\"summary\":\"Veteran declined to respond \",\"name\":\"Veteran declined to respond \",\"section\":\"2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Veteran declined to respond\"}],\"type\":\"text\"},{\"type\":\"elseif\",\"summary\":\"pcl_score formula gt 43\",\"name\":\"elseif_pcl_score formula_gt_43\",\"section\":\"2.2\",\"children\":[{\"type\":\"text\",\"summary\":\"Ask your clinician for further evaluation and treatment options  \",\"name\":\"Ask your clinician for further\",\"section\":\"2.2.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"Ask your clinician for further evaluation and treatment options \"}],\"type\":\"text\"}],\"operator\":\"gt\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1929,\"name\":\"pcl_score\",\"displayName\":\"pcl_score formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"43\"},\"conditions\":[],\"type\":\"elseif\"},{\"type\":\"elseif\",\"summary\":\"pcl_score formula lte 43\",\"name\":\"elseif_pcl_score formula_lte_43\",\"section\":\"2.3\",\"children\":[{\"type\":\"text\",\"summary\":\"You may ask a clinician for help in the future if you feel you may have symptoms of PTSD \",\"name\":\"You may ask a clinician for he\",\"section\":\"2.3.1\",\"children\":[],\"contents\":[{\"type\":\"text\",\"content\":\"You may ask a clinician for help in the future if you feel you may have symptoms of PTSD\"}],\"type\":\"text\"}],\"operator\":\"lte\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1929,\"name\":\"pcl_score\",\"displayName\":\"pcl_score formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"43\"},\"conditions\":[],\"type\":\"elseif\"}],\"operator\":\"nresult\",\"left\":{\"type\":\"var\",\"content\":{\"id\":1929,\"name\":\"pcl_score\",\"displayName\":\"pcl_score formula\",\"typeId\":4,\"measureId\":null,\"measureTypeId\":null,\"measureAnswerId\":null,\"transformations\":[]}},\"right\":{\"type\":\"text\",\"content\":\"\"},\"conditions\":[],\"type\":\"if\"}]',
graph_params='{\"varId\":1929,\"title\":\"My PTSD Score\",\"footer\":null,\"numberOfMonths\":12,\"score\":\"${getFormulaValue(var1929)}\",\"intervals\":{\"Negative\":17.0,\"Positive\":44.0},\"maxXPoint\":85.0,\"ticks\":[17.0,31.0,44.0,65.0,85.0]}'
where template_id=310;
